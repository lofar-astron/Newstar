<HEAD>
<TITLE>No Title</TITLE>
</HEAD>
<BODY><P>
 <b>The program NCLEAN</b>
<P>
<A NAME=.contents><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A>
<P><H2><A NAME=SECTION0001000000000000000>Contents</A></H2>
<UL> 
<LI> <A NAME=tex2html1 HREF=nclean_descr.html#SECTION0001000000000000000>Contents</A>
<LI> <A NAME=tex2html2 HREF=nclean_descr.html#SECTION0002000000000000000>  <b>Overview</b></A>
<LI> <A NAME=tex2html3 HREF=nclean_descr.html#SECTION0003000000000000000>  <b>NCLEAN versus NMODEL FIND</b></A>
<UL> 
<LI> <A NAME=tex2html4 HREF=nclean_descr.html#SECTION0003100000000000000>  <b>Beam Clean = H&#246;gbom Clean</b></A>
<LI> <A NAME=tex2html5 HREF=nclean_descr.html#SECTION0003200000000000000>  <b>UV Clean = Clark Clean </b></A>
<LI> <A NAME=tex2html6 HREF=nclean_descr.html#SECTION0003300000000000000>  <b>Data clean = Cotton-Schwab Clean</b></A>
<LI> <A NAME=tex2html7 HREF=nclean_descr.html#SECTION0003400000000000000> <b>&quot;Component&quot; clean: A quick-and dirty Clean</b></A>
</UL> 
<LI> <A NAME=tex2html8 HREF=nclean_descr.html#SECTION0004000000000000000>  <b>Residual maps</b></A>
<LI> <A NAME=tex2html9 HREF=nclean_descr.html#SECTION0005000000000000000> <b>Missing items to be added</b></A>
</UL>
<A NAME=.overview><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
<H1><A NAME=SECTION0002000000000000000>  <b>Overview</b></A></H1>
<P>
        NCLEAN is a relatively simple implementation of a number of Clean algorithms.  According to its writer (WNB), more elaborate and versatile implementations exist in AIPS and GIPSY.
<P>
        NCLEAN makes extensive use of the 
<A HREF="../nmodel_descr/nmodel_descr.html"><em>source model</em></A> facilities. A source model is a list of source components.  The user has considerable latitude in manipulating such models; for example, NCLEAN allows one to restore source components that were inserted in the model by mechanisms other than Clean and are not on grid points.  Since it is left to the user to decide what is &quot;correct&quot; and what not, such facilities should be used only by experts and with caution.
<P>
<A NAME=.nclean.interface><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> Overview of the actions in NCLEAN. } 
<A HREF="../fig/nclean_interface.ps"><STRONG>FIGURE</STRONG></A> 
 .]{<i><A HREF=" #.nclean.interface">Figure</A> shows an overview of the options available in NCLEAN.  The program's basic Clean function is implemented in several forms to be discussed below.  In addition, there is a separate option to restore a map from a source model in a 
<A HREF="../nmodel_descr/nmodel_descr.html"><em>MDL file</em></A>, and an option to produce a histogram of the intensities of a collection of map areas.
<P>
        The components found are stored in a source model in core. NCLEAN will ask the user for an MDL file to store the list; if he specifies none, the 
<A HREF="../nmodel_descr/nmodel_descr.html"><em>NMODEL HANDLE</em></A> process will be activated to process the list.
<P>
<A NAME=.nclean.versus><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
</i><H1><A NAME=SECTION0003000000000000000>  <b>NCLEAN versus NMODEL FIND</b></A></H1>
<P>
        The Clean algorithm is fundamentally limited by its basic paradigm, <em>viz.</em> attempting to represent a continuous brightness contribution as a superposition of point sources on map-grid points. This approach is inadequate for small sources if dynamic ranges in excess of, say, 1000 are aimed for.
<P>
        On the other hand, Clean is the only mechanism available to construct models for extended sources that cannot be adequately represented by a model with at most a few parameters. Note, however, that Clean has difficulty guessing the missing information for extended sources which results in the notorious problem of <em>corrugations. Modifications to Clean's search algorithm have proved succesful in suppressing these corrugations (whichref&quot;SDI Clean&quot;), but they are not available in NCLEAN.
<P>
        As an alternative, Newstar has the option of FINDing sources with the program <A HREF="../nmodel_descr/nmodel_descr.html">NMODEL</A>.  This method is superior for sources of small extent, since it does not confine their positions to be on grid points and desribes their shapes in terms of an ellipse with three parameters (axes and orientation).  In doing this, FIND can also take the effects of bandwidth smearing and finite integration time into account.
<P>
        FIND is therefore the recommended way of building models of small sources.  Cleaning must be used for sources that do not fit the shape restrictions on FIND sources.  Obviously, Clean and FIND may have to be used in combination, in such a way that all source components in the model take the form that best fits their real appearance.
<P>
<A NAME=.beam.clean><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
</em><H2><A NAME=SECTION0003100000000000000>  <b>Beam Clean = H&#246;gbom Clean</b></A></H2>
<P>
        H&#246;gbom's original <b>Clean method is known in Newstar as <b>Beam Clean</b>.  It consists of repeatedly finding the highest point in (part of) a map (the <em>search area</em>) and subtracting a source component at that position from the entire map or some part of it (the <em>clean area</em>). The subtracted component consists of the antenna pattern shifted and multiplied by the peak intensity of the source and a <em>gain factor</em>.  This factor is usually chosen somewhat smaller then 1 to account for the fact that part of the intensity found may be due to sidelobes from other sources.
<P>
        The subtraction may be problematic in cases where the shifted antenna pattern does not cover the entire clean area.  Moreover, the edges of both the map and the antenna pattern are contaminated by aliasing effects.  For this reason cleaning is best restricted to an area somewhat less than the central half of the map in both dimensions.
<P>
        In the NEWSTAR version, the search area coincides with the clean area. It is defined as the union of at most 32 rectangles specified by the user. Since subtraction occurs only in the search area, sidelobes in the remainder of the map are not removed.  It is therefore not advisable to successively clean different areas; nor is it necessary, since NCLEAN allows you to specify all relevant areas simultaneously.
<P>
        H&#246;gbom Clean is controlled by the parameters
<P>
<UL><LI>   <A HREF="../nclean_private_keys/nclean_private_keys.html#.loop.gain"><b>LOOP_GAIN</b></A>: the gain factor;
<P>
<LI>   <A HREF="../nclean_private_keys/nclean_private_keys.html#.compon.limit"><b>COMPON_LIMIT</b></A>: the number of source components at which the process will stop;
<P>
<LI>   <A HREF="../nclean_private_keys/nclean_private_keys.html#.clean.limit"><b>CLEAN_LIMIT</b></A>: the absolute maximum intensity in the residual map at which the process will stop;
<P>
<LI>   <A HREF="../nclean_private_keys/nclean_private_keys.html#.area"><b>AREA</b></A> (prompt repeats until a null answer is given): the map areas in which source components are looked for 
and subtracted. </UL>
<P>
<A NAME=.prussian.hat><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
        An additional parameter, 
<A HREF="../nclean_private_keys/nclean_private_keys.html#.prussian.hat"><b>PRUSSIAN_HAT</b></A>, allows one to stick a delta-function peak on the centre of the antenna pattern, which in certain cases gives better results (Cornwell ...).
<P>
<A NAME=.uv.clean><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
</b><H2><A NAME=SECTION0003200000000000000>  <b>UV Clean = Clark Clean </b></A></H2>
<P>
        <b>UV Clean</b>, more hgenerally known as <b>Clark Clean speeds up the cleaning of extended sources which must be represented by a large number of closely spaced point-source components. Sources are found in the same way as for H&#246;gbom Clean.  But rather than subtracting them one by one in the entire search area, Clark Clean does only a provisional subtraction in a small <em>patch</em> around the source position.  Proper subtraction is done later by jointly convolving the sources collected with the antenna pattern and subtracting the result.
<P>
        The convolution is implemented through Fourier transformations and a multiplication in the visibility plane, which is considerably faster than a direct convolution in the map domain.  However, this method suffers from aliasing errors similar to those for Beam Clean and is therefore subject to the same limitations.
<P>
        In UV Clean <em>minor cycles</em>, in each of which a single source component is located and provisionally subtracted, alternate with <em>major cycles</em> in which the newly found sources are properly removed. The number of minor cycles between successive major cycles is controlled by an algorithm that estimates the buildup of deviations in the residual map due to the provisional nature of component subtractions.  The user has a few parameters to control this algorithm.
<P>
        UV Clean is controlled by the same parameters as H&#246;gbom Clean. In addition, the number of minor cycles to a major one is controlled by the parameters:
<P>
<UL><A NAME=.cycle.depth><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
<LI>   <A HREF="../nclean_private_keys/nclean_private_keys.html#.cycle.depth"><b>CYCLE_DEPTH</b></A>: The lower limit to components to be found in minor cycles relative to the present absolute residual-map maximum.
<P>
<A NAME=.grating.factor><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
<LI> <A HREF="../nclean_private_keys/nclean_private_keys.html#.grating.factor"><b>GRATING_FACTOR</b></A>: A multiplier to be applied to the estimate of the maximum error buildup in the minor cycles.  The default of 1 is supposed to guarantee that grating responses will not erroneously be mistaken for source components.  A lower value allows a larger number of minor cycles per major cycle, but should be used only to the extent that there is no danger of mistakes. The <A HREF="#.compon"><b>COMPON</b></A> clean option can be used to explore this effect prior to starting serious work.
<P>
</UL>
<P>
        In map-making, a taper rising toward the map edges may have been applied to the final map to componsate for the effect of the gridding convolution in the UV plane.  The parameter 
<A HREF="../nclean_private_keys/nclean_private_keys.html#.deconvolution"><b>DECONVOLUTION</b></A> controls if the effect of this must be taken into account in cleaning.
<P>
<A NAME=.data.clean><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
</b><H2><A NAME=SECTION0003300000000000000>  <b>Data clean = Cotton-Schwab Clean</b></A></H2>
<P>
        &quot;Data&quot; Clean is the somewhat unfortunate name given to the &quot;Cotton-Schwab&quot; modification of <A HREF="#.uv.clean">Clark Clean</A>) in which the model subtraction is done in the <A HREF="../scn_descr/scn_descr.html">SCN file(s)</A> from which the map was originally made.  In this way aliasing effects are completely avoided, albeit at the expense of again much more processing.
<P>
        Since a Newstar map does not include a detailed bookkeeping of the SCN files and control parameters with which it was made, the user has to respecify them as part of the process.  This is not as bad as it may sound, because no harm will be done if the new map is made with different specifications provided only that a corresponding antenna pattern is generated along with it.  The user may actually take advantage of this, e.g.  by specifying a smaller map area if he has found that that is all he needs.
<P>
        Since the antenna beam plays no role in source subtraction, the 
<A HREF="#.prussian.hat"><b>PRUSSIAN_HAT</b></A> parameter is not used in Data Clean.
<P>
        An important practical point to note is that <em>the residual map overwrites the input map</em>. This is discussed further 
<A HREF="#.residual.maps">below</A>.
<P>
<A NAME=.compon><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
<H2><A NAME=SECTION0003400000000000000> <b>&quot;Component&quot; clean: A quick-and dirty Clean</b></A></H2>
<P>
        Another Clean option is available in NCLEAN, in which only the minor-cycle part of a Clark or &quot;Data&quot; Clean is performed.  Since the minor-cycle source subtraction is of a sloppy nature, the residual map should <em>not</em> be used as a starting point for further investigations. However, the source model can be used, e.g.  as a starting point for 
<A HREF="../ncalib/ncalib.html#.redun">Selfcal</A> or <A HREF="../nmodel_descr/nmodel_descr.html">NMODEL UPDATE</A>.
<P>
        Another possible use is to quickly explore the effect of the <b>CYCLE_DEPTH</b> and <b>GRATING_FACTOR</b> 
<A HREF="#.cycle.depth">parameters</A> before embarking on a lengthy Clark or Data Clean.
<P>
<A NAME=.residual.maps><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
<H1><A NAME=SECTION0004000000000000000>  <b>Residual maps</b></A></H1>
<P>
        Residual maps have the same size as their parent map. For H&#246;gbom and Clark Clean, they are stored in the .WMP file from which the input map was taken, under the index
<P>
        &lt;group&gt;.&lt;field&gt;.&lt;channel&gt;.&lt;polarisation&gt;.1.&lt;sequence_number&gt;
<P>
where &lt;group&gt;...  are the same as those of the input file, the type 1 indicates a map and &lt;sequence_number&gt; is the first new number available. Thus, derivatives of a map will form a contiguous sequence in the order in which they were created.
<P>
        For Data Clean the residual map is written in place of the original. The idea behind this is that, unlike for the other Clean modes, one may backtrack from a Data Clean operation without recourse to the input map: What one does instead is to discard the newly found model components and then regenerate the input map with the previous model.
<P>
        In whichever way one cleans, backtracking implies that one must keep track of which residual maps are rejected. There is (as yet?) no mechanism available to remove them from a .WMP file except for selectively 
<A HREF="../nmap_descr/nmap_descr.html#.copy">copying</A> maps to a new .WMP file.
<P>
<A NAME=.missing><IMG ALIGN=MIDDLE SRC="../icons/invis_anchor.png"></A> 
<H1><A NAME=SECTION0005000000000000000> <b>Missing items to be added</b></A></H1>
<P>
<UL><LI>   Litterature references 
<LI>   Beam-patch calculation and other details of minor-cycle clean 
<LI>   RESTORE details 
</UL>
<P>

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

<P>.

</BODY> </HTML> 
<HR>

</BODY>
<P><ADDRESS>
newstar@nfra.nl

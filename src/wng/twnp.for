C+ TWNP.FOR
C  WNB 890418
C
C  Revisions:
C	HjV 920708	Add INCLUDE 'WNG_DEF'
C
	SUBROUTINE TWNP(DEV)
C
C  Main routine to test plotting.
C			DEV_C*: Command line input, ie device
C
C  Include files:
C
	INCLUDE 'WNG_DEF'
C
C  Parameters:
C
C
C  Arguments:
C
	CHARACTER*(*) DEV		!DEVICE TO DO
C
C  Function references:
C
C
C  Data declarations:
C
C
C	REAL PI
C	  DATA PI/3.1415927/
	INTEGER WQID,WQID1
	REAL P(8)
	  DATA P/.25,.33,.5,.67,.9,.9,.1,.5/
	REAL Q(4)
	  DATA Q/0,0,2.,2./
	REAL Q1(4)
	  DATA Q1/0.1,0,.4,.4/
	REAL Q2(4)
	  DATA Q2/0,0,.25,1./
	REAL Q3(4)
	  DATA Q3/0.28,.35,1.,.65/
	REAL R(2,0:200)
	REAL T(2,7)
	  DATA T/.1,.1,0.02,.2,0.02,.3,0.02,.4,0.02,.5,0.02,.6,0.02,.7/
	REAL T1(2)
	  DATA T1/-1.,1./
	REAL TQ(0:1,0:1,3)
	  DATA TQ/.1,.1,.9,.9,.1,.5,.9,.5,.5,.1,.5,.9/
	REAL X1(153)
	REAL XP(0:1)
	  DATA XP/.25,.25/
	REAL XDP(0:1,0:1)
	  DATA XDP/.01,0.,0,.01/
	REAL RANGE(0:1)
	  DATA RANGE/-20.,20./
	REAL PRANGE(0:1)
	  DATA PRANGE/0.1,1./
	REAL RRANGE(0:1)
	  DATA RRANGE/-.5,1./
C
	CALL WNCAUC(DEV)			!MAKE UPPER CASE
	CALL WQOPEN				!OPEN AND DEVICE
	CALL WQDVOP(WQID,DEV)
	CALL WQDVAC(WQID)
C
CC	CALL WQSWIN(1,Q)			!CLIPPING, WINDOWING
CC	CALL WQSVIE(1,Q1)
C	CALL WQSDVW(WQID,Q2)
C	CALL WQSNTR(1,Q1,Q1)
CC	CALL WQSLNT(1)
CC	CALL WQSCLP(.TRUE.)
C
C	CALL WQSNTR(1,Q3,Q3)			!TRANSFORM
C
C	CALL WQMSG(WQID,'Kopje')		!MESSAGE
	CALL WQ_DATE(WQID,'Kop je')
C
CC	GOTO 10
CC	GOTO 30
CC	GOTO 40
CC	GOTO 50
C
C	CALL WQSTXH(.1)				!TEXT
	CALL WQSTXH(.025)
	CALL WQSTXU(T1)
	CALL WQSTXS(.25)
	CALL WQTEXT(P,'A')
	CALL WQTEXT(T(1,1),'abcdefghijklmn')
	CALL WQTEXT(T(1,2),'opqrstuvwxyz')
	CALL WQTEXT(T(1,3),'ABCDEFGHIJKLMN')
	CALL WQTEXT(T(1,4),'OPQRSTUVWXYZ')
	CALL WQTEXT(T(1,5),'!@#$%^&*()_-+={[}]')
	CALL WQTEXT(T(1,6),'`~0123456789:;''"|')
	CALL WQTEXT(T(1,7),'?/.,<>	C C')
C
C	CALL WQSLNT(1)					!CLIPPING
C	CALL WQSCLP(.TRUE.)
C
CC	CALL WQPOLM(4,P,2)				!MARKS
	CALL WQPOLM_IX(4,P,2)
C
C	CALL WQSPLR(WQID,1,1,4.)			!THICK LINES
C							!CIRCLES
	DO I=0,200
	  R(1,I)=.5+.25*SIN(.0628319*I/2.)
	  R(2,I)=.5+.25*COS(.0628319*I/2.)
	END DO
	CALL WQSPLI(3)
	CALL WQPOLL(201,R)
	DO I0=1,4
	  R0=0.025*I0
	  DO I=0,200
	    R(1,I)=.5+R0+(.25-R0)*SIN(.0628319*I/2.)
	    R(2,I)=.5+(.25-R0)*COS(.0628319*I/2.)
	  END DO
	  CALL WQPOLL_IX(201,R,I0)
	END DO
C
	CALL WQPOLL_IX(2,TQ(0,0,1),4)			!DASHES
	CALL WQPOLL_IX(2,TQ(0,0,2),4)
	CALL WQPOLL_IX(2,TQ(0,0,3),4)
CC	GOTO 20
C
 10	CONTINUE
	CALL WQ_CONI(J0,26,XP,XDP,1,0.)			!INIT CONT
	DO I=-25,0
	  R1=I
	  DO I1=-25,25
	    R0=I1
	    R0=SQRT(ABS(R0)**2.+ABS(R1)**2.)*PI/5.+1E-5
	    X1(I1+26)=((SIN(R0)/R0)**2)
	    X1(I1+77)=R0*COS(R0)-SIN(R0)
	    X1(I1+128)=SIN(R0)
	  END DO
	  CALL WQ_CONT(J0,X1(52))
	END DO
	CALL WQ_CONX(J0)				!EXIT CONT
CC	GOTO 20
C
 30	CONTINUE
	XP(0)=XP(0)+25*XDP(0,0)
	CALL WQ_SHADI(J0,26,XP,XDP,0,RANGE,0.)		!INIT SHADING
	DO I=-25,0
	  R1=I
	  DO I1=-25,25
	    R0=I1
	    R0=SQRT(ABS(R0)**2.+ABS(R1)**2.)*PI/5.+1E-5
	    X1(I1+26)=((SIN(R0)/R0)**2)
	    X1(I1+77)=R0*COS(R0)-SIN(R0)
	    X1(I1+128)=SIN(R0)
	  END DO
	  CALL WQ_SHADE(J0,X1(77))
	END DO
	CALL WQ_SHADX(J0)				!EXIT SHADE
CC	GOTO 20
C
 40	CONTINUE
	XP(1)=XP(1)+25*XDP(1,1)
	CALL WQ_POLI(J0,26,XP,XDP,0.25,PRANGE,0.)	!INIT POL.
	DO I=0,25
	  R1=I
	  DO I1=-25,25
	    R0=I1
	    R0=SQRT(ABS(R0)**2.+ABS(R1)**2.)*PI/5.+1E-5
	    X1(I1+26)=((SIN(R0)/R0)**2)
	    X1(I1+77)=R0*COS(R0)-SIN(R0)
	    X1(I1+128)=I1*PI/100.+I*PI/100.
	  END DO
	  CALL WQ_POLT(J0,X1(1),X1(128))
	END DO
	CALL WQ_POLX(J0)				!EXIT POL
CC	GOTO 20
C
 50	CONTINUE
	XP(0)=XP(0)-25*XDP(0,0)
	CALL WQ_RULI(J0,26,XP,XDP,0.25,RRANGE,0.,0)	!INIT RULED
	DO I=0,25
	  R1=I
	  DO I1=-25,25
	    R0=I1
	    R0=SQRT(ABS(R0)**2.+ABS(R1)**2.)*PI/5.+1E-5
	    X1(I1+26)=((SIN(R0)/R0)**2)
	    X1(I1+77)=R0*COS(R0)-SIN(R0)
	    X1(I1+128)=I1*PI/100.+I*PI/100.
	  END DO
	  CALL WQ_RULE(J0,X1(1))
	END DO
	CALL WQ_RULX(J0)				!EXIT RULED
CC	GOTO 20
C
 20	CONTINUE
	CALL WQDVDA(WQID)				!CLOSE
	CALL WQDVCL(WQID)
	CALL WQCLOS
C
	END
